<!doctype html>
<html class="theme-next use-motion ">
<head>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>


    <meta name="description" content="notes for study" />



  <meta name="keywords" content="IOS,Responder Chain," />



  <link rel="alternate" href="/atom.xml" title="Yt's Blog" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    analytics: {
      google: ''
    },
    sidebar: 'post'
  };
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?b8a916e09c6b39221eb089c8ad75ede9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <title> iOS Event Delivery/ The Responder Chain // Yt's Blog </title>
</head>

<body>
<!--[if lte IE 8]> <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'> <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari." style='margin-left:auto;margin-right:auto;display: block;'/></a></div> <![endif]-->
  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Yt's Blog</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>


  <ul id="menu" class="menu">
     
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br />
          首頁
        </a>
      </li>
    
      
      <li class="menu-item menu-item-categories">
        <a href="/categories">
          <i class="menu-item-icon icon-categories"></i> <br />
          分類
        </a>
      </li>
    
      
      <li class="menu-item menu-item-about">
        <a href="/about">
          <i class="menu-item-icon icon-about"></i> <br />
          關於
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br />
          歸檔
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br />
          標籤
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              iOS Event Delivery/ The Responder Chain
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-13
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/IOS/">IOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/07/13/iOS-Event-Delivery-The-Responder-Chain/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/07/13/iOS-Event-Delivery-The-Responder-Chain/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        <h2 id="Event_Delivery:_The_Responder_Chain">Event Delivery: The Responder Chain</h2><p>当你设计应用的时候, 应用需要动态响应事件. 例如: 点击事件, (可以在显示屏上的不同对象上多次触发), 你需要决定那个对象来响应此事件, 并且需要了解这个对象是如何接收事件的.</p>
<p>当用户触发一个事件时, UIKit 创建一个<code>event object</code>, 此对象包含了需要处理的信息. 然后将此事件对象放入到当前 app 的事件队列中. 例如<code>touch</code>事件, 这种事件对象就是一个包含了一组<code>touch</code>的<code>UIEvent</code> 对象. <code>motion</code>事件, 此对象由你使用的<code>framework</code>和你感兴趣的<code>motion</code>类型来决定.</p>
<ul>
<li>Touch events. 当前 window 对象首先尝试将事件传送给 <code>touch</code> 触发的视图.这个视图被称为<code>hit-test</code> 视图. 寻找<code>hit-test</code>视图的过程被称为<code>hit-testing</code>, 将在下面描述.</li>
<li>Motion and remote control events. 对于这些事件, 当前 window 对象会将 <code>shaking-motion</code> 或 <code>emote control event</code> 发送给<code>first responder</code>来响应.<code>first responder</code>也将在下面描述.</li>
</ul>
<h3 id="Hit-Testing_Returns_the_View_Where_a_Touch_Occurred">Hit-Testing Returns the View Where a Touch Occurred</h3><p>iOS 通过<code>hit-testing</code> 来寻找点击下方的视图. <code>Hit-Testing</code> 会查找任何包含该<code>touch</code>点坐标的视图对象, 规则为此坐标位于视图的<code>bounds</code>中, 如果包含, 会继续递归检测此视图的所有子视图. 在视图树中包含该点击的最下层视图, 即是<code>hit-test</code>视图. 当 iOS 决定了 <code>hit-test</code> 视图后, 会将点击事件发送给此视图来处理.</p>
<p>说明如下, 假设用户点击了视图 E, iOS 查找<code>hit-test</code> 视图的逻辑如下:</p>
<ol>
<li>点击在视图 A 的范围内, 然后检测 子视图 B 和 C</li>
<li>点击不再视图 B 范围内, 但是在视图 C 范围内, 继续检测 子视图 D 和 E</li>
<li>点击不再视图 D 里, 但是在视图 E 中.<a id="more"></a>
视图 E 是最下层且包含 <code>touch</code>的视图树, 所以就是<code>hit-test</code></li>
</ol>
<p><img src="https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Art/hit_testing_2x.png" alt=""></p>
<p><code>hitTest:withEvent:</code> 方法接受参数<code>CGPoint</code> 和 <code>UIEvent</code>, 返回<code>hit-test</code> 视图. <code>hitTest:withEvent:</code>方法首先<code>调用</code>在调用者自身使用<code>pointInside:withEvent:</code> 方法. 如果传入的参数<code>point</code> 包含在视图的<code>bounds</code>中, 返回 YES , 然后继续递归调用所有子视图.</p>
<p>如果传入的参数点位置不在当前视图的范围内, 第一次调用<code>pointInside:withEvent:</code>返回 NO. 然后该点将被忽略, 然后<code>hitTest:withEvent:</code>将返回<code>nil</code>. 如意一个子视图返回 NO, 之后的视图树将被忽略, 因为该点如果不再这个子视图, 也必将不会在子视图的子视图. 这意味着<em>任何</em>超出父视图范围的子视图内的所有点, 将不能接受到<code>touch</code>事件,  因为点击的位置要同时位于父视图和子视图中. 在子视图的<code>clipsToBounds</code> 属性被设置为 NO, 可能发生.</p>
<blockquote>
<p>即使点击之后超出了<code>hit-test</code>视图,  该点击对象还会和对应的<code>hit-test</code>视图一直绑定, 直到该点击结束.</p>
</blockquote>
<p><code>hit-test</code>视图拥有优先响应处理该点击事件的权利, 如果该视图不能处理, 则事件将向上沿着这个视图的反应链查找, 直到找到能处理为止.</p>
<p>下面是<a href="http://stackoverflow.com/questions/4961386/event-handling-for-ios-how-hittestwithevent-and-pointinsidewithevent-are-r" target="_blank" rel="external">stackoverflow</a>的相关举例</p>
<h4 id="例子1">例子1</h4><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------------------------+</span><br><span class="line">|<span class="string">A                                                      </span>|</span><br><span class="line">|<span class="string"> +--------- +          +-----------------+   </span>|</span><br><span class="line">|<span class="string"> </span>|<span class="string"> B           </span>|<span class="string">          </span>|<span class="string">   C                  </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string"> </span>|<span class="string">              </span>|<span class="string">           </span>|<span class="string">  +----------+    </span>|<span class="string">    </span>|<span class="string">  </span><br><span class="line"></span>|<span class="string"> +--------- +          </span>|<span class="string">   </span>|<span class="string">  D         </span>|<span class="string">     </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">                            </span>|<span class="string">   </span>|<span class="string">+---------+   </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string">                           +------------------+   </span>|</span><br><span class="line">+--------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>Say you put your finger inside D. Here’s what will happen:</p>
<ol>
<li><p><code>hitTest:withEvent:</code> is called on <code>A</code>, the top-most view of the view hierarchy.</p>
</li>
<li><p><code>pointInside:withEvent:</code> is called recursively on each view.</p>
<ol>
<li>1 <code>pointInside:withEvent:</code>  is called on <code>A</code>, and returns <code>YES</code><br>2.2 <code>pointInside:withEvent:</code>is called on <code>B</code>, and returns <code>NO</code><br>2.3 <code>pointInside:withEvent: i</code>s called on <code>C</code>, and returns <code>YES</code><br>2.4 <code>pointInside:withEvent:</code>is called on <code>D</code>, and returns <code>YES</code></li>
</ol>
</li>
<li><p>On the views that returned <code>YES</code>, it will look down on the hierarchy to see the subview where the touch took place. In this case, from A, C and D, it will be D.</p>
</li>
<li><p>D will be the hit-test view</p>
</li>
</ol>
<h4 id="例子2">例子2</h4><p>+——————————————+<br>|A +————+                  |<br>|  |B    +———————+    |<br>|  |       |C            X  |    |<br>|  |      +———————-+   |<br>|  |            |                    |<br>|  +————+                   |<br>|                                    |<br>+——————————————+</p>
<p>Assume X - user’s touch. pointInside:withEvent: on B returns NO, so hitTest:withEvent: returns A. I wrote category on UIView to handle issue when you need to receive touch on top most visible view.</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)overlapHitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span><span class="variable">.userInteractionEnabled</span> || [<span class="keyword">self</span> isHidden] || <span class="keyword">self</span><span class="variable">.alpha</span> == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="built_in">UIView</span> *hitView = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span> pointInside:point withEvent:event]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span><span class="variable">.clipsToBounds</span>) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">        <span class="keyword">else</span> hitView = <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">UIView</span> *subview <span class="keyword">in</span> [<span class="keyword">self</span><span class="variable">.subviewsreverseObjectEnumerator</span>]) &#123;</span><br><span class="line">        <span class="built_in">CGPoint</span> insideSubview = [<span class="keyword">self</span> convertPoint:point toView:subview];</span><br><span class="line">        <span class="built_in">UIView</span> *sview = [subview overlapHitTest:insideSubview withEvent:event];</span><br><span class="line">        <span class="keyword">if</span> (sview) <span class="keyword">return</span> sview;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    <span class="keyword">return</span> hitView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>We should not send touch events for hidden or transparent views, or views with userInteractionEnabled set to NO;</li>
<li>If touch is inside self, self will be considered as potential result.</li>
<li>Check recursively all subviews for hit. If any, return it.</li>
<li>Else return self or nil depending on result from step 2.</li>
</ol>
<p>Note, <code>[self.subviewsreverseObjectEnumerator]</code>needed to follow view hierarchy from top most to bottom. And check for <code>clipsToBounds</code> to ensure not to test masked subviews.</p>
<p>Usage:</p>
<ol>
<li>Import category in your subclassed view.</li>
<li>Replace hitTest:withEvent: with this<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (UIView *)<span class="string">hitTest:</span>(CGPoint)point <span class="string">withEvent:</span>(UIEvent *)event &#123;</span><br><span class="line">    <span class="keyword">return</span> [self <span class="string">overlapHitTest:</span>point <span class="string">withEvent:</span>event];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="The_Responder_Chain_Is_Made_Up_of_Responder_Objects">The Responder Chain Is Made Up of Responder Objects</h3><p>Many types of events rely on a responder chain for event delivery. The responder chain is a series of linked responder objects. It starts with the first responder and <strong><em>ends with the application object</em></strong>. If the first responder cannot handle an event, it forwards the event to the next responder in the responder chain.</p>
<p>A responder object is an object that can respond to and handle events. The <code>UIResponder</code> class is the base class for all responder objects, and it defines the programmatic interface not only for event handling but also for common responder behavior. Instances of the <code>UIApplication</code>, <code>UIViewController</code>, and <code>UIView</code> classes are responders, which means that all views and most key controller objects are responders. Note that <strong><em>Core Animation layers are not responders</em></strong>.</p>
<p>The first responder is designated to receive events first. Typically, the first responder is a view object. An object becomes the first responder by doing two things:</p>
<ol>
<li>Overriding the <code>canBecomeFirstResponder</code> method to return YES.</li>
<li>Receiving a <code>becomeFirstResponder</code> message. If necessary, an object can send itself this message.</li>
</ol>
<blockquote>
<p>Note: Make sure that your app has established its object graph before assigning an object to be the first responder. For example, you typically call the <code>becomeFirstResponder</code> method in an override of the <code>viewDidAppear:</code>method. If you try to assign the first responder in viewWillAppear:, your object graph is not yet established, so the <code>becomeFirstResponder</code> method returns NO.</p>
</blockquote>
<p>Events are not the only objects that rely on the responder chain. The responder chain is used in all of the following:</p>
<ul>
<li><p>Touch events. If the hit-test view cannot handle a touch event, the event is passed up a chain of responders that starts with the hit-test view.</p>
</li>
<li><p>Motion events. To handle shake-motion events with UIKit, the first responder must implement either the motionBegan:withEvent: or motionEnded:withEvent: method of the UIResponder class, as described in Detecting Shake-Motion Events with UIEvent.</p>
</li>
<li><p>Remote control events. To handle remote control events, the first responder must implement the remoteControlReceivedWithEvent: method of the UIResponder class.</p>
</li>
<li><p>Action messages. When the user manipulates a control, such as a button or switch, and the target for the action method is nil, the message is sent through a chain of responders starting with the control view.</p>
</li>
<li><p>Editing-menu messages. When a user taps the commands of the editing menu, iOS uses a responder chain to find an object that implements the necessary methods (such as cut:, copy:, and paste:). For more information, see Displaying and Managing the Edit Menu and the sample code project, CopyPasteTile.</p>
</li>
<li><p>Text editing. When a user taps a text field or a text view, that view automatically becomes the first responder. By default, the virtual keyboard appears and the text field or text view becomes the focus of editing. You can display a custom input view instead of the keyboard if it’s appropriate for your app. You can also add a custom input view to any responder object. For more information, see Custom Views for Data Input.<br>UIKit automatically sets the text field or text view that a user taps to be the first responder; Apps must explicitly set all other first responder objects with the becomeFirstResponder method.</p>
</li>
</ul>
<p>UIKit automatically sets the text field or text view that a user taps to be the first responder; Apps must explicitly set all other first responder objects with the becomeFirstResponder method.</p>
<h3 id="The_Responder_Chain_Follows_a_Specific_Delivery_Path">The Responder Chain Follows a Specific Delivery Path</h3><p>If the initial object—either the hit-test view or the first responder—doesn’t handle an event, UIKit passes the event to the next responder in the chain. Each responder decides whether it wants to handle the event or pass it along to its own next responder by calling the nextResponder method.This process continues until a responder object either handles the event or there are no more responders.</p>
<p>The responder chain sequence begins when iOS detects an event and passes it to an initial object, which is typically a view. The initial view has the first opportunity to handle an event. Figure 2-2 shows two different event delivery paths for two app configurations. An app’s event delivery path depends on its specific construction, but all event delivery paths adhere to the same heuristics.<br><img src="https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Art/iOS_responder_chain_2x.png" alt=""></p>
<p>For the app on the left, the event follows this path:</p>
<ol>
<li><p>The initial view attempts to handle the event or message. If it can’t handle the event, it passes the event to its superview, because the initial view is not the top most view in its view controller’s view hierarchy.</p>
</li>
<li><p>The superview attempts to handle the event. If the superview can’t handle the event, it passes the event to its superview, because it is still not the top most view in the view hierarchy.</p>
</li>
<li><p>The topmost view in the view controller’s view hierarchy attempts to handle the event. If the topmost view can’t handle the event, it passes the event to its view controller.</p>
</li>
<li><p>The view controller attempts to handle the event, and if it can’t, passes the event to the window.</p>
</li>
<li><p>If the window object can’t handle the event, it passes the event to the singleton app object.</p>
</li>
<li><p>If the app object can’t handle the event, it discards the event.</p>
</li>
</ol>
<p>The app on the right follows a slightly different path, but all event delivery paths follow these heuristics:</p>
<ol>
<li><p>A view passes an event up its view controller’s view hierarchy until it reaches the topmost view.</p>
</li>
<li><p>The topmost view passes the event to its view controller.</p>
</li>
<li><p>The view controller passes the event to its topmost view’s superview.<br>Steps 1-3 repeat until the event reaches the root view controller.</p>
</li>
<li><p>The root view controller passes the event to the window object.</p>
</li>
<li><p>The window passes the event to the app object.</p>
</li>
</ol>
<blockquote>
<p>Important: If you implement a custom view to handle remote control events, action messages, shake-motion events with UIKit, or editing-menu messages, don’t forward the event or message to nextResponder directly to send it up the responder chain. Instead, invoke the superclass implementation of the current event handling method and let UIKit handle the traversal of the responder chain for you.</p>
</blockquote>

      
    </div>

    <div class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/IOS/"> #IOS </a>
          
            <a href="/tags/Responder-Chain/"> #Responder Chain </a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/13/iOS-Runtime-运行时类与对象的编译处理/">iOS Runtime 运行时类与对象的编译处理</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/13/iOS-Runtime-成员变量与属性/">iOS Runtime 成员变量与属性</a>
            
          </div>
        </div>
      

      
      
    </div>
  </div>



    
      <div class="comments" id="comments">
        
          <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
        
      </div>
    
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目錄
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            本站概覽
          </li>
        </ul>
      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/avatar.png" alt="Yt" />
          <p class="site-author-name">Yt</p>
        </div>
        <p class="site-description motion-element">notes for study</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">136</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">分類</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">59</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/ytlvy" target="_blank">GitHub</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/ytlvy" target="_blank">Twitter</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://nshipster.com" target="_blank">NSHipster</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.mikeash.com/pyblog" target="_blank">NSBlog</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.objc.io" target="_blank">objcio</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.raywenderlich.com" target="_blank">raywenderlich</a>
            </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

      </div>

      
        <div class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Event_Delivery:_The_Responder_Chain"><span class="nav-number">1.</span> <span class="nav-text">Event Delivery: The Responder Chain</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hit-Testing_Returns_the_View_Where_a_Touch_Occurred"><span class="nav-number">1.1.</span> <span class="nav-text">Hit-Testing Returns the View Where a Touch Occurred</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#例子1"><span class="nav-number">1.1.1.</span> <span class="nav-text">例子1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#例子2"><span class="nav-number">1.1.2.</span> <span class="nav-text">例子2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The_Responder_Chain_Is_Made_Up_of_Responder_Objects"><span class="nav-number">1.2.</span> <span class="nav-text">The Responder Chain Is Made Up of Responder Objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The_Responder_Chain_Follows_a_Specific_Delivery_Path"><span class="nav-number">1.3.</span> <span class="nav-text">The Responder Chain Follows a Specific Delivery Path</span></a></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </div>
      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Yt</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="theme-info">
  <span id="busuanzi_container_site_uv">
    &nbsp&nbsp&nbsp&nbsp|&nbsp&nbsp Total <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span> views.
您是本站的第<span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span>个小伙伴
<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Hits
  </span>
<div>
      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js"></script>


  <script type="text/javascript" src="/js/helpers.js"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js" id="motion.global"></script>




  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var $sidebarInner = $('.sidebar-inner');
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.didShow', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;
          var self = this;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      $(indicator).velocity('stop').velocity({
        opacity: action === 'show' ? 0.4 : 0
      }, { duration: 100 });
    }

  });
</script>


  <script type="text/javascript" id="sidebar.nav">
    $(document).ready(function () {
      var html = $('html');

      $('.sidebar-nav li').on('click', function () {
        var item = $(this);
        var activeTabClassName = 'sidebar-nav-active';
        var activePanelClassName = 'sidebar-panel-active';
        if (item.hasClass(activeTabClassName)) {
          return;
        }

        var currentTarget = $('.' + activePanelClassName);
        var target = $('.' + item.data('target'));

        currentTarget.velocity('transition.slideUpOut', 200, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', 200)
            .addClass(activePanelClassName);
        });

        item.siblings().removeClass(activeTabClassName);
        item.addClass(activeTabClassName);
      });

      $('.post-toc a').on('click', function (e) {
        e.preventDefault();
        var offset = $(escapeSelector(this.getAttribute('href'))).offset().top;
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        });
      });

      // Expand sidebar on post detail page by default, when post has a toc.
      var $tocContent = $('.post-toc-content');
      if (isDesktop() && CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          displaySidebar();
        }
      }
    });
  </script>




  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  

    
      
    

    <script type="text/javascript">
      var disqus_shortname = 'ytlvy';
      var disqus_identifier = '2015/07/13/iOS-Event-Delivery-The-Responder-Chain/';
      var disqus_title = 'iOS Event Delivery/ The Responder Chain';
      var disqus_url = 'http://ytlvy.com/2015/07/13/iOS-Event-Delivery-The-Responder-Chain/';

      (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }());
    </script>
  




  
  

</body>
</html>
